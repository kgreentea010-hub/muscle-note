<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>筋トレノート</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 16px;
    }
    h1 {
      text-align: center;
    }
    .card {
      background: #fff;
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 8px;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      font-size: 16px;
    }
    button {
      background: #007aff;
      color: white;
      border: none;
      border-radius: 6px;
    }
    .record {
      margin-top: 6px;
    }
  </style>
</head>
<body>

<h1>筋トレノート</h1>

<div class="card">
  <input id="date" type="date">
  <input id="menu" placeholder="種目（例：ベンチプレス）">
  <input id="weight" placeholder="重量（kg）" type="number">
  <input id="reps" placeholder="回数" type="number">
  <button onclick="addRecord()">記録する</button>
</div>

<div class="card">
  <h2>記録一覧</h2>
  <div id="records"></div>
</div>
<div class="card">
　<h2>種目別履歴</h2>
  <select id="filterMenu">
    <option value="">種目を選択</option>
  </select>
  <div id="filteredRecords"></div>
</div>

<script>
  const filterMenuEl = document.getElementById("filterMenu");
  const filteredRecordsEl = document.getElementById("filteredRecords");
  const recordsEl = document.getElementById("records");
  const dateEl = document.getElementById("date");
  const menuEl = document.getElementById("menu");
  const weightEl = document.getElementById("weight");
  const repsEl = document.getElementById("reps");

  let records = JSON.parse(localStorage.getItem("records")) || [];

  function addRecord() {
    if (!menuEl.value || !weightEl.value || !repsEl.value) return;

    records.push({
      date: dateEl.value || new Date().toISOString().slice(0, 10),
      menu: menuEl.value,
      weight: weightEl.value,
      reps: repsEl.value
    });

    menuEl.value = "";
    weightEl.value = "";
    repsEl.value = "";
    dateEl.value = "";

    render();
}
 function updateMenuOptions() {
  const menus = [...new Set(records.map(r => r.menu))];

  filterMenuEl.innerHTML = '<option value="">種目を選択</option>';

  menus.forEach(menu => {
    const option = document.createElement("option");
    option.value = menu;
    option.textContent = menu;
    filterMenuEl.appendChild(option);
  });
}
    render();
  }

  function deleteRecord(record) {
    records = records.filter(r =>
      !(r.date === record.date &&
        r.menu === record.menu &&
        r.weight === record.weight &&
        r.reps === record.reps)
    );
    render();
  }

  function render() {
    recordsEl.innerHTML = "";

    const grouped = {};

    records.forEach(r => {
      if (!grouped[r.date]) {
        grouped[r.date] = [];
      }
      grouped[r.date].push(r);
    });

    Object.keys(grouped)
      .sort()
      .reverse()
      .forEach(date => {
        const title = document.createElement("h3");
        title.textContent = date;
        recordsEl.appendChild(title);

        grouped[date].forEach(r => {
          const div = document.createElement("div");
          div.className = "record";

          const span = document.createElement("span");
          span.textContent = `・${r.menu}：${r.weight}kg × ${r.reps}回`;

          const btn = document.createElement("button");
          btn.textContent = "削除";
          btn.style.marginLeft = "8px";
          btn.onclick = () => deleteRecord(r);

          div.appendChild(span);
          div.appendChild(btn);
          recordsEl.appendChild(div);
        });
      });

    localStorage.setItem("records", JSON.stringify(records));
    updateMenuOptions();
  }
filterMenuEl.addEventListener("change", () => {
  const selected = filterMenuEl.value;
  filteredRecordsEl.innerHTML = "";

  if (!selected) return;

  records
    .filter(r => r.menu === selected)
    .forEach(r => {
      const div = document.createElement("div");
      div.className = "record";
      div.textContent = `${r.date}｜${r.weight}kg × ${r.reps}回`;
      filteredRecordsEl.appendChild(div);
    });
});
  render();
</script>
</body>
</html>
